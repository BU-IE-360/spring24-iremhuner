
#install.packages("ggplot2")
library(ggplot2)

# dataset_1
dataset_1 <- data.frame(
  Date = c("2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12", 
           "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12",
           "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12",
           "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12",
           "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12",
           "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12",
           "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12",
           "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12"),
  TP_AKONUTSAT2_TOPLAM = c(26584.00, 30455.00, 38822.00, 33429.00, 35423.00, 36371.00, 23756.00, 36458.00, 
                      42083.00, 48110.00, 48941.00, 49076.00, 35993.00, 38676.00, 50424.00, 43334.00, 
                      41738.00, 35210.00, 38575.00, 38743.00, 40534.00, 38593.00, 37250.00, 34029.00, 
                      28678.00, 27916.00, 32786.00, 27912.00, 36865.00, 47648.00, 30405.00, 12743.00, 
                      11330.00, 8065.00, 5324.00, 7148.00, 6537.00, 8890.00, 22762.00, 22461.00, 14916.00, 
                      7319.00, 13064.00, 34148.00, 57811.00, 50411.00, 43911.00, 50278.00, 42237.00, 
                      43733.00, 43329.00, 17088.00, 18483.00, 101504.00, 130721.00, 76019.00, 35576.00, 
                      25566.00, 24450.00, 14631.00, 10732.00, 14669.00, 21815.00, 17514.00, 10560.00, 
                      28878.00, 20553.00, 27375.00, 29759.00, 28049.00, 39366.00, 45260.00, 18183.00, 
                      19888.00, 30271.00, 32030.00, 29335.00, 40610.00, 19146.00, 22168.00, 16970.00, 
                      13268.00, 16655.00, 21796.00, 16203.00, 17357.00, 25262.00, 21769.00, 27476.00, 
                      13463.00, 14533.00, 16375.00, 8446.00, 5577.00, 5245.00, 6042.00)
)


dataset_1$Date <- as.Date(paste(dataset_1$Date, "-01", sep = ""), format = "%Y-%m-%d")
dataset_1$TP_AKONUTSAT2_TOPLAM <- as.numeric(gsub(",", "", dataset_1$TP_AKONUTSAT2_TOPLAM))

# Plot
ggplot(dataset_1, aes(x = Date, y = TP_AKONUTSAT2_TOPLAM)) +
  geom_line() +
  labs(title = "Time Series of TP_AKONUTSAT2_TOPLAM",
       x = "Date",
       y = "TP_AKONUTSAT2_TOPLAM")

# dataset_2
dataset_2 <- data.frame(
  Date = c("2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12",
           "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12",
           "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12",
           "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12",
           "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12",
           "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12",
           "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12",
           "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12"),
  TP_DK_USD_S_YTL = c(3.01, 2.95, 2.9, 2.84, 2.93, 2.92, 2.96, 2.97, 2.97, 3.07, 3.27, 3.5,
                      3.74, 3.68, 3.67, 3.66, 3.57, 3.53, 3.57, 3.52, 3.47, 3.67, 3.89, 3.85,
                      3.78, 3.78, 3.89, 4.06, 4.42, 4.64, 4.76, 5.74, 6.38, 5.87, 5.38, 5.32,
                      5.38, 5.27, 5.45, 5.75, 6.06, 5.82, 5.68, 5.63, 5.72, 5.79, 5.74, 5.85,
                      5.93, 6.06, 6.33, 6.83, 6.96, 6.82, 6.86, 7.27, 7.52, 7.89, 8.02, 7.73,
                      7.41, 7.09, 7.64, 8.17, 8.36, 8.61, 8.63, 8.49, 8.53, 9.16, 10.54, 13.55,
                      13.54, 13.65, 14.59, 14.71, 15.65, 17, 17.42, 18.03, 18.31, 18.6, 18.62,
                      18.67, 18.79, 18.86, 19, 19.34, 19.72, 23.11, 26.47, 27, 26.99, 27.85,
                      28.64, 29.07)
)

dataset_2$Date <- as.Date(paste(dataset_2$Date, "-01", sep = ""), format = "%Y-%m-%d")

# Plot
ggplot(dataset_2, aes(x = Date, y = TP_DK_USD_S_YTL)) +
  geom_line() +
  labs(title = "Time Series of TP_DK_USD_S_YTL",
       x = "Date",
       y = "TP_DK_USD_S_YTL")


# dataset_3
dataset_3 <- data.frame(
  Date = c("2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12",
           "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12",
           "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12",
           "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12",
           "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12",
           "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12",
           "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12",
           "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12"),
  TP.TIG07 = c(46.40, 46.00, 46.00, 46.50, 46.40, 46.20, 45.90, 46.20, 45.80, 46.30,
               46.30, 46.10, 45.90, 46.20, 45.80, 46.40, 47.00, 46.50, 47.20, 47.30,
               47.20, 47.50, 47.60, 47.60, 47.70, 47.40, 47.50, 47.60, 47.50, 47.30,
               47.70, 47.30, 47.30, 47.00, 46.60, 46.40, 45.50, 45.70, 46.30, 45.60,
               46.00, 45.70, 45.50, 45.30, 45.30, 45.40, 45.70, 45.50, 44.80, 44.90,
               42.40, 40.30, 41.00, 42.20, 41.70, 43.00, 43.20, 42.90, 42.90, 42.90,
               44.20, 43.70, 44.80, 44.60, 44.10, 44.90, 45.00, 45.40, 46.20, 46.30,
               46.20, 46.80, 46.80, 46.70, 46.80, 47.30, 47.80, 47.60, 46.90, 47.90,
               47.70, 47.90, 48.40, 48.10, 48.70, 48.00, 47.90, 48.40, 48.50, 47.90,
               48.30, 48.40, 48.20, 48.60, 48.20, 48.80)
)

dataset_3$Date <- as.Date(paste(dataset_3$Date, "-01", sep = ""), format = "%Y-%m-%d")

# Plot
ggplot(dataset_3, aes(x = Date, y = TP.TIG07)) +
  geom_line() +
  labs(title = "Time Series of TP.TIG07",
       x = "Date",
       y = "TP.TIG07")


######################################################################

# Correlation coefficient between dataset_1 and dataset_2
correlation_1_2 <- cor(dataset_1$TP_AKONUTSAT2_TOPLAM, dataset_2$TP_DK_USD_S_YTL)
print(correlation_1_2)

# Correlation coefficient between dataset_1 and dataset_3
correlation_1_3 <- cor(dataset_1$TP_AKONUTSAT2_TOPLAM, dataset_3$TP.TIG07)
print(correlation_1_3)

# Correlation coefficient between dataset_2 and dataset_3
correlation_2_3 <- cor(dataset_2$TP_DK_USD_S_YTL, dataset_3$TP.TIG07)
print(correlation_2_3)

#######################################################################

# dataset_4
dataset_4 <- data.frame(
  Date = c("2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12",
           "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12",
           "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12",
           "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12",
           "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12",
           "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12",
           "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12",
           "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12"),
  Zam = c(14, 5, 3, 2, 3, 3, 8, 3, 4, 3, 5, 14,
          9, 4, 3, 4, 4, 7, 10, 5, 6, 6, 6, 9,
          11, 5, 4, 9, 11, 8, 17, 14, 12, 9, 7, 15,
          20, 9, 6, 18, 8, 10, 14, 38, 10, 8, 7, 13,
          15, 8, 5, 4, 9, 9, 14, 5, 6, 5, 5, 13,
          15, 5, 4, 4, 5, 7, 15, 12, 6, 21, 23, 63,
          62, 27, 47, 25, 43, 65, 44, 15, 15, 18, 12, 33,
          50, 13, 30, 25, 31, 39, 100, 38, 25, 18, 18, 25)
)

# Date to Date format Conversion
dataset_4$Date <- as.Date(paste(dataset_4$Date, "-01", sep = ""), format = "%Y-%m-%d")

# Plot
ggplot(dataset_4, aes(x = Date, y = Zam)) +
  geom_line() +
  labs(title = "Time Series of Zam",
       x = "Date",
       y = "Zam")

##########################################################################

#install.packages("GGally")
library(GGally)

# Your four datasets
data1 <- data.frame(
  Date = seq(as.Date("2016-01-01"), by = "month", length.out = 48),
  TP_AKONUTSAT2_TOPLAM = c(26584.00, 30455.00, 38822.00, 33429.00, 35423.00, 36371.00, 23756.00, 36458.00, 
                           42083.00, 48110.00, 48941.00, 49076.00, 35993.00, 38676.00, 50424.00, 43334.00, 
                           41738.00, 35210.00, 38575.00, 38743.00, 40534.00, 38593.00, 37250.00, 34029.00, 
                           28678.00, 27916.00, 32786.00, 27912.00, 36865.00, 47648.00, 30405.00, 12743.00, 
                           11330.00, 8065.00, 5324.00, 7148.00, 6537.00, 8890.00, 22762.00, 22461.00, 14916.00, 
                           7319.00, 13064.00, 34148.00, 57811.00, 50411.00, 43911.00, 50278.00, 42237.00, 
                           43733.00, 43329.00, 17088.00, 18483.00, 101504.00, 130721.00, 76019.00, 35576.00, 
                           25566.00, 24450.00, 14631.00, 10732.00, 14669.00, 21815.00, 17514.00, 10560.00, 
                           28878.00, 20553.00, 27375.00, 29759.00, 28049.00, 39366.00, 45260.00, 18183.00, 
                           19888.00, 30271.00, 32030.00, 29335.00, 40610.00, 19146.00, 22168.00, 16970.00, 
                           13268.00, 16655.00, 21796.00, 16203.00, 17357.00, 25262.00, 21769.00, 27476.00, 
                           13463.00, 14533.00, 16375.00, 8446.00, 5577.00, 5245.00, 6042.00)
)

data2 <- data.frame(
  Date = seq(as.Date("2016-01-01"), by = "month", length.out = 48),
  TP_DK_USD_S_YTL = c(3.01, 2.95, 2.9, 2.84, 2.93, 2.92, 2.96, 2.97, 2.97, 3.07, 3.27, 3.5,
                      3.74, 3.68, 3.67, 3.66, 3.57, 3.53, 3.57, 3.52, 3.47, 3.67, 3.89, 3.85,
                      3.78, 3.78, 3.89, 4.06, 4.42, 4.64, 4.76, 5.74, 6.38, 5.87, 5.38, 5.32,
                      5.38, 5.27, 5.45, 5.75, 6.06, 5.82, 5.68, 5.63, 5.72, 5.79, 5.74, 5.85,
                      5.93, 6.06, 6.33, 6.83, 6.96, 6.82, 6.86, 7.27, 7.52, 7.89, 8.02, 7.73,
                      7.41, 7.09, 7.64, 8.17, 8.36, 8.61, 8.63, 8.49, 8.53, 9.16, 10.54, 13.55,
                      13.54, 13.65, 14.59, 14.71, 15.65, 17, 17.42, 18.03, 18.31, 18.6, 18.62,
                      18.67, 18.79, 18.86, 19, 19.34, 19.72, 23.11, 26.47, 27, 26.99, 27.85,
                      28.64, 29.07)
)

data3 <- data.frame(
  Date = seq(as.Date("2016-01-01"), by = "month", length.out = 48),
  TP.TIG07 = c(46.40, 46.00, 46.00, 46.50, 46.40, 46.20, 45.90, 46.20, 45.80, 46.30,
               46.30, 46.10, 45.90, 46.20, 45.80, 46.40, 47.00, 46.50, 47.20, 47.30,
               47.20, 47.50, 47.60, 47.60, 47.70, 47.40, 47.50, 47.60, 47.50, 47.30,
               47.70, 47.30, 47.30, 47.00, 46.60, 46.40, 45.50, 45.70, 46.30, 45.60,
               46.00, 45.70, 45.50, 45.30, 45.30, 45.40, 45.70, 45.50, 44.80, 44.90,
               42.40, 40.30, 41.00, 42.20, 41.70, 43.00, 43.20, 42.90, 42.90, 42.90,
               44.20, 43.70, 44.80, 44.60, 44.10, 44.90, 45.00, 45.40, 46.20, 46.30,
               46.20, 46.80, 46.80, 46.70, 46.80, 47.30, 47.80, 47.60, 46.90, 47.90,
               47.70, 47.90, 48.40, 48.10, 48.70, 48.00, 47.90, 48.40, 48.50, 47.90,
               48.30, 48.40, 48.20, 48.60, 48.20, 48.80)
)

data4 <- data.frame(
  Date = seq(as.Date("2016-01-01"), by = "month", length.out = 48),
  Zam = c(14, 5, 3, 2, 3, 3, 8, 3, 4, 3, 5, 14,
          9, 4, 3, 4, 4, 7, 10, 5, 6, 6, 6, 9,
          11, 5, 4, 9, 11, 8, 17, 14, 12, 9, 7, 15,
          20, 9, 6, 18, 8, 10, 14, 38, 10, 8, 7, 13,
          15, 8, 5, 4, 9, 9, 14, 5, 6, 5, 5, 13,
          15, 5, 4, 4, 5, 7, 15, 12, 6, 21, 23, 63,
          62, 27, 47, 25, 43, 65, 44, 15, 15, 18, 12, 33,
          50, 13, 30, 25, 31, 39, 100, 38, 25, 18, 18, 25)
)

# All datasets are combined into one
combined_data <- merge(merge(merge(data1, data2, by = "Date"), data3, by = "Date"), data4, by = "Date")

# Plot scatterplot matrix, it give 4x4 scatterplot matrix
ggpairs(combined_data, columns = c(2:5))



#############################################################################

#fitting a regression model
dataset_1$Date <- as.Date(dataset_1$Date)
dataset_4$Date <- as.Date(dataset_4$Date)

# Based on the Date column dataset_1 and dataset_4 are merged
merged_data <- merge(dataset_1, dataset_4, by = "Date")

# Time series regression model is fitted
regressionmodel1 <- lm(TP_AKONUTSAT2_TOPLAM ~ Zam, data = merged_data)

summary(regressionmodel1)

# ACF of residuals
residuals <- residuals(regressionmodel1)
#install.packages("forecast")
library(forecast)
acf(residuals, main = "ACF Plot of Residuals for Regression Model 1")

ggplot(merged_data, aes(x = Zam, y = TP_AKONUTSAT2_TOPLAM)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue")
labs(x = "Zam", y = "TP_AKONUTSAT2_TOPLAM")
ggtitle("Regression Model: TP_AKONUTSAT2_TOPLAM ~ Zam")

#######################################################################

#fitting a regression model
dataset_2$Date <- as.Date(dataset_2$Date)
dataset_4$Date <- as.Date(dataset_4$Date)

# Based on the Date column dataset_2 and dataset_4 are merged
merged_data <- merge(dataset_2, dataset_4, by = "Date")

# Time series regression model is fitted
regressionmodel2 <- lm(TP_DK_USD_S_YTL ~ Zam, data = merged_data)

summary(regressionmodel2)

# ACF of residuals
residuals <- residuals(regressionmodel2)
#install.packages("forecast")
library(forecast)
acf(residuals, main = "ACF Plot of Residuals for Regression Model 2")

ggplot(merged_data, aes(x = Zam, y = TP_DK_USD_S_YTL)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red")
labs(x = "Zam", y = "TP_DK_USD_S_YTL")
ggtitle("Regression Model: TP_DK_USD_S_YTL ~ Zam")


###############################################################

#fitting a regression model
dataset_3$Date <- as.Date(dataset_3$Date)
dataset_4$Date <- as.Date(dataset_4$Date)

# Based on the Date column dataset_3 and dataset_4 are merged
merged_data <- merge(dataset_3, dataset_4, by = "Date")

# Time series regression model is fitted
regressionmodel3 <- lm(TP.TIG07 ~ Zam, data = merged_data)

summary(regressionmodel3)


# ACF of residuals
residuals <- residuals(regressionmodel3)
#install.packages("forecast")
library(forecast)
acf(residuals, main = "ACF Plot of Residuals for Regression Model 3")


ggplot(merged_data, aes(x = Zam, y = TP.TIG07)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "green")
labs(x = "Zam", y = "TP.TIG07")
ggtitle("Regression Model: TP.TIG07 ~ Zam")


